import{S as pe,b as ce,s as J,d as G,k as _,m as b,o as W,p as Y,e as K,A as de,u as ge,q as he,D as xe,v as _e,K as z,L as Q,x as F,M as X,z as q,y as A,g as $,j as ee,n as te}from"./utils-Dhpz6cMF.js";import{w as be}from"./index-DOampWFA.js";import{G as Me}from"./GameFrame-CzJCdGM3.js";import P from"./Math-DRVBjLM2.js";/* empty css                                           */const ke=[{id:1,ops:["+","-"],min:1,max:9,total:12,desc:"Single-digit addition and subtraction"},{id:2,ops:["+","-","x"],min:1,max:9,total:12,desc:"Intro to multiplication with friendly tables",multiples:[2,5,10]},{id:3,ops:["+","-","x","/"],min:1,max:9,total:14,desc:"Introduce exact division (kept within range)",multiples:[3,4]},{id:4,ops:["+","-"],min:1,max:20,total:14,desc:"Add/sub within 1â€“20"},{id:5,ops:["x","/"],min:2,max:12,total:16,desc:"Times tables up to 12 (and their divisions)",multiples:[2,3,4,5,10]},{id:6,ops:["+","-","x","/"],min:1,max:30,total:18,desc:"Mixed up to 30",multiples:[2,5,10]},{id:7,ops:["+","-","x","/"],min:1,max:50,total:18,desc:"Mixed up to 50",multiples:[4,6,8]},{id:8,ops:["+","-","x","/"],min:1,max:80,total:20,desc:"Trickier multiples practice",multiples:[7,8,9]},{id:9,ops:["+","-","x","/"],min:1,max:90,total:20,desc:"Patterns and accuracy",multiples:[3,6,9]},{id:10,ops:["+","-","x","/"],min:1,max:99,total:22,desc:"Full two-digit practice (up to 99)"},{id:11,ops:["+","-"],min:10,max:199,total:18,desc:"Hundreds addition and subtraction"},{id:12,ops:["+","-","x"],min:1,max:199,total:20,desc:"Products with two/three digits",multiples:[5,10,25]},{id:13,ops:["+","-","x","/"],min:1,max:249,total:20,desc:"Mixed practice up to 250"},{id:14,ops:["+","-","x","/"],min:1,max:399,total:22,desc:"Mixed up to 399",multiples:[4,8,12]},{id:15,ops:["+","-","x","/"],min:1,max:499,total:22,desc:"Mixed up to 499"},{id:16,ops:["+","-","x","/"],min:1,max:699,total:24,desc:"Trickier factors",multiples:[7,11,13]},{id:17,ops:["+","-","x","/"],min:1,max:799,total:24,desc:"Heavier practice",multiples:[9,12,16]},{id:18,ops:["+","-","x","/"],min:1,max:899,total:24,desc:"Approaching thousands"},{id:19,ops:["+","-","x","/"],min:1,max:950,total:24,desc:"Round-number multiples",multiples:[20,25,50]},{id:20,ops:["+","-","x","/"],min:1,max:999,total:26,desc:"Three-digit mixed challenge (up to 999)"}];function ne(n){return ke.find(r=>r.id===n)}function ye(n){return ne(n+1)}const C=be(0);let L=null;function we(n){S(),C.set(n),L=window.setInterval(()=>{C.update(r=>r<=1?(S(),0):r-1)},1e3)}function Te(){S(),C.set(0)}function S(){L&&(clearInterval(L),L=null)}function Ee(n){let r,e;return r=new P({props:{expr:"\\text{Get ready...}"}}),{c(){A(r.$$.fragment)},m(a,i){q(r,a,i),e=!0},p:te,i(a){e||(b(r.$$.fragment,a),e=!0)},o(a){_(r.$$.fragment,a),e=!1},d(a){F(r,a)}}}function Le(n){let r,e;return r=new P({props:{expr:`\\text{Time left: } ${n[1].toFixed(1)}\\text{s}`}}),{c(){A(r.$$.fragment)},m(a,i){q(r,a,i),e=!0},p(a,i){const u={};i&2&&(u.expr=`\\text{Time left: } ${a[1].toFixed(1)}\\text{s}`),r.$set(u)},i(a){e||(b(r.$$.fragment,a),e=!0)},o(a){_(r.$$.fragment,a),e=!1},d(a){F(r,a)}}}function Ie(n){let r,e,a,i;const u=[Le,Ee],t=[];function d(o,s){return o[0]?1:0}return e=d(n),a=t[e]=u[e](n),{c(){r=$("span"),a.c(),ee(r,"slot","footer-left")},m(o,s){K(o,r,s),t[e].m(r,null),i=!0},p(o,s){let m=e;e=d(o),e===m?t[e].p(o,s):(W(),_(t[m],1,1,()=>{t[m]=null}),Y(),a=t[e],a?a.p(o,s):(a=t[e]=u[e](o),a.c()),b(a,1),a.m(r,null))},i(o){i||(b(a),i=!0)},o(o){_(a),i=!1},d(o){o&&G(r),t[e].d()}}}function Ce(n){let r,e,a;return e=new P({props:{expr:`\\text{Range: } ${n[2].min}\\text{--}${n[2].max}\\quad \\text{Ops: } ${n[2].ops.join("\\,")}`}}),{c(){r=$("span"),A(e.$$.fragment),ee(r,"slot","footer-right")},m(i,u){K(i,r,u),q(e,r,null),a=!0},p(i,u){const t={};u&4&&(t.expr=`\\text{Range: } ${i[2].min}\\text{--}${i[2].max}\\quad \\text{Ops: } ${i[2].ops.join("\\,")}`),e.$set(t)},i(i){a||(b(e.$$.fragment,i),a=!0)},o(i){_(e.$$.fragment,i),a=!1},d(i){i&&G(r),F(e)}}}function Z(n){let r,e,a,i;function u(o){n[16](o)}function t(o){n[17](o)}let d={title:"MathRaining",levelId:n[2].id,total:n[2].total,correct:n[11],question:n[3].question,flash:n[6],penalty:n[7],overlayLabel:n[8],overlayColor:n[9],overlayTrigger:n[10],handleInput:n[12],handleInputKey:n[13],$$slots:{"footer-right":[Ce],"footer-left":[Ie]},$$scope:{ctx:n}};return n[5]!==void 0&&(d.inputEl=n[5]),n[4]!==void 0&&(d.input=n[4]),r=new Me({props:d}),z.push(()=>Q(r,"inputEl",u)),z.push(()=>Q(r,"input",t)),{c(){A(r.$$.fragment)},m(o,s){q(r,o,s),i=!0},p(o,s){const m={};s&4&&(m.levelId=o[2].id),s&4&&(m.total=o[2].total),s&2048&&(m.correct=o[11]),s&8&&(m.question=o[3].question),s&64&&(m.flash=o[6]),s&128&&(m.penalty=o[7]),s&256&&(m.overlayLabel=o[8]),s&512&&(m.overlayColor=o[9]),s&1024&&(m.overlayTrigger=o[10]),s&67108871&&(m.$$scope={dirty:s,ctx:o}),!e&&s&32&&(e=!0,m.inputEl=o[5],X(()=>e=!1)),!a&&s&16&&(a=!0,m.input=o[4],X(()=>a=!1)),r.$set(m)},i(o){i||(b(r.$$.fragment,o),i=!0)},o(o){_(r.$$.fragment,o),i=!1},d(o){F(r,o)}}}function Se(n){let r=n[3].id,e,a,i=Z(n);return{c(){i.c(),e=de()},m(u,t){i.m(u,t),K(u,e,t),a=!0},p(u,[t]){t&8&&J(r,r=u[3].id)?(W(),_(i,1,1,te),Y(),i=Z(u),i.c(),b(i,1),i.m(e.parentNode,e)):i.p(u,t)},i(u){a||(b(i),a=!0)},o(u){_(i),a=!1},d(u){u&&G(e),i.d(u)}}}const Fe=8e3;function qe(n){return n<2e3?{label:"perfect",color:"#4C5B5C"}:n<4e3?{label:"great",color:"#2F52E0"}:n<6e3?{label:"good",color:"#BCED09"}:n<8e3?{label:"bad",color:"#F9CB40"}:{label:"miss",color:"#FF715B"}}function I(n,r){return Math.floor(Math.random()*(r-n+1))+n}function x(n,r,e){if(e<=1)return I(Math.max(1,n),r);const a=Math.max(1,Math.ceil(n/e)),i=Math.floor(r/e);return i<a?I(Math.max(1,n),r):e*I(a,i)}function g(n,r){return I(Math.max(1,n),r)}function Ae(n,r,e){let a=Fe;return(n==="x"||n==="/")&&(a+=2e3),Math.max(Math.abs(r),Math.abs(e))>=50&&(a+=1500),a}function De(n,r,e){let a,i;ge(n,C,l=>e(1,i=l));const u=he();let t=ne(1),d,o="",s=null,m=0,w=!1,D=!1,M=!0,T=!1,v=performance.now(),H=0,B="",j="",N=0;function re(){const l=t.ops[Math.floor(Math.random()*t.ops.length)],f=Array.isArray(t.multiples)&&t.multiples.length>0,h=f?t.multiples[Math.floor(Math.random()*t.multiples.length)]:1;let p=t.min,c=t.min;if(l==="+")p=f?x(t.min,t.max,h):g(t.min,t.max),c=f?x(t.min,t.max,h):g(t.min,t.max);else if(l==="-")p=f?x(t.min,t.max,h):g(t.min,t.max),c=f?x(t.min,t.max,h):g(t.min,t.max);else if(l==="x")p=f?x(t.min,t.max,h):g(t.min,t.max),c=f?x(t.min,t.max,h):g(t.min,t.max);else{let fe=0,O=!1,y=1;for(;fe++<20&&!O;){y=f?Math.max(1,x(1,Math.max(1,t.max),h)):Math.max(1,g(1,Math.max(1,t.max)));const R=Math.min(t.max,Math.floor(t.max/y));R<1||(c=f?Math.max(1,x(1,R,h)):g(1,R),p=y*c,p>=1&&p<=t.max&&(O=!0))}O||(c=Math.max(1,g(t.min,t.max)),y=Math.max(1,g(t.min,t.max)),p=y*c)}const E=l==="+"?p+c:l==="-"?p-c:l==="x"?p*c:p/c,ue=`\\displaystyle ${p} \\; ${l==="+"?"+":l==="-"?"-":l==="x"?"\\times":"\\div"} \\; ${c}`,me=Ae(l,p,c);return{id:Math.random().toString(36).slice(2)+Date.now().toString(36),a:p,b:c,op:l,answer:E,question:ue,timeMs:me}}function U(){e(3,d=re()),M?Te():we(d.timeMs/1e3),e(15,T=!1),v=performance.now()}function oe(){e(14,m=0),e(4,o=""),e(6,w=!1),e(0,M=!0),U()}oe();function k(l){let f=l.replace(/[^0-9\-]/g,"");if(f.indexOf("-")>0&&(f=f.replace(/-/g,"")),e(4,o=f),!f)return;if(Number(f)===d.answer){H=performance.now()-v;const p=qe(H);e(8,B=p.label),e(9,j=p.color),e(10,N+=1),e(6,w=!0),e(14,m+=1),u("answer",{correct:!0});const c=m>=t.total;setTimeout(()=>{if(c){const E=ye(t.id);E&&(e(2,t=E),e(14,m=0),e(0,M=!0))}else e(0,M=!1);e(4,o=""),e(6,w=!1),U()},160)}}function ae(l){k(l.target.value)}function V(l){const f=l.target.tagName;if(["INPUT","TEXTAREA","SELECT"].includes(f))return l.target===s,void 0;if(l.key==="Backspace"){e(4,o=o.slice(0,-1)),k(o),l.preventDefault();return}if((l.key==="-"||l.key===" ")&&o.length===0){e(4,o="-"),k(o),l.preventDefault();return}if(/^[0-9]$/.test(l.key)){e(4,o+=l.key),k(o),l.preventDefault();return}l.key==="Escape"&&(e(4,o=""),l.preventDefault())}function ie(l){if(l.key==="Shift"){l.preventDefault(),e(4,o="");return}l.key==="Control"||l.key==="Alt"||l.key==="Meta"||l.key===" "&&o.length===0&&(l.preventDefault(),e(4,o="-"),k(o))}xe(()=>{window.addEventListener("keydown",V),setTimeout(()=>s==null?void 0:s.focus(),0)}),_e(()=>{window.removeEventListener("keydown",V),S()});function le(l){s=l,e(5,s)}function se(l){o=l,e(4,o)}return n.$$.update=()=>{n.$$.dirty&50179&&i<=0&&!T&&!M&&(u("answer",{correct:!1}),e(15,T=!0),e(14,m-=2),e(8,B="miss"),e(9,j="#FF715B"),e(10,N+=1),e(7,D=!0),setTimeout(()=>{e(7,D=!1)},200)),n.$$.dirty&16384&&e(11,a=m<0?0:m)},[M,i,t,d,o,s,w,D,B,j,N,a,ae,ie,m,T,le,se]}class Ke extends pe{constructor(r){super(),ce(this,r,De,Se,J,{})}}export{Ke as default};
