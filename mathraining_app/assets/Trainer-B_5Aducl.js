import{S as pe,d as ce,e as v,h as P,t as T,b as E,a as de,c as he,l as G,A as ge,F as xe,G as Me,J as _e,K as Q,L as Z,x as K,M as W,z as H,y as U,p as $,k as ee,v as ye}from"./index-CnHZdLKm.js";import{G as we}from"./GameFrame-ByUlgiOW.js";import te from"./Math-s0qYSVkv.js";import"./SubNav-ClqkzwBv.js";/* empty css                                           */const be=[{id:1,ops:["+","-"],min:1,max:9,total:12,desc:"Single-digit addition and subtraction"},{id:2,ops:["+","-","x"],min:1,max:9,total:12,desc:"Intro to multiplication with friendly tables",multiples:[2,5,10]},{id:3,ops:["+","-","x","/"],min:1,max:9,total:14,desc:"Introduce exact division (kept within range)",multiples:[3,4]},{id:4,ops:["+","-"],min:1,max:20,total:14,desc:"Add/sub within 1–20"},{id:5,ops:["x","/"],min:2,max:12,total:16,desc:"Times tables up to 12 (and their divisions)",multiples:[2,3,4,5,10]},{id:6,ops:["+","-","x","/"],min:1,max:30,total:18,desc:"Mixed up to 30",multiples:[2,5,10]},{id:7,ops:["+","-","x","/"],min:1,max:50,total:18,desc:"Mixed up to 50",multiples:[4,6,8]},{id:8,ops:["+","-","x","/"],min:1,max:80,total:20,desc:"Trickier multiples practice",multiples:[7,8,9]},{id:9,ops:["+","-","x","/"],min:1,max:90,total:20,desc:"Patterns and accuracy",multiples:[3,6,9]},{id:10,ops:["+","-","x","/"],min:1,max:99,total:22,desc:"Full two-digit practice (up to 99)"},{id:11,ops:["+","-"],min:10,max:199,total:18,desc:"Hundreds addition and subtraction"},{id:12,ops:["+","-","x"],min:1,max:199,total:20,desc:"Products with two/three digits",multiples:[5,10,25]},{id:13,ops:["+","-","x","/"],min:1,max:249,total:20,desc:"Mixed practice up to 250"},{id:14,ops:["+","-","x","/"],min:1,max:399,total:22,desc:"Mixed up to 399",multiples:[4,8,12]},{id:15,ops:["+","-","x","/"],min:1,max:499,total:22,desc:"Mixed up to 499"},{id:16,ops:["+","-","x","/"],min:1,max:699,total:24,desc:"Trickier factors",multiples:[7,11,13]},{id:17,ops:["+","-","x","/"],min:1,max:799,total:24,desc:"Heavier practice",multiples:[9,12,16]},{id:18,ops:["+","-","x","/"],min:1,max:899,total:24,desc:"Approaching thousands"},{id:19,ops:["+","-","x","/"],min:1,max:950,total:24,desc:"Round-number multiples",multiples:[20,25,50]},{id:20,ops:["+","-","x","/"],min:1,max:999,total:26,desc:"Three-digit mixed challenge (up to 999)"}];function ne(t){return be.find(o=>o.id===t)}function ke(t){return ne(t+1)}function Te(t){let o,e,i;return e=new te({props:{expr:`\\displaystyle \\text{Time: } ${((performance.now()-t[11])/1e3).toFixed(1)}\\,\\text{s}`}}),{c(){o=$("span"),U(e.$$.fragment),ee(o,"slot","footer-left")},m(r,n){G(r,o,n),H(e,o,null),i=!0},p(r,n){const u={};n&2048&&(u.expr=`\\displaystyle \\text{Time: } ${((performance.now()-r[11])/1e3).toFixed(1)}\\,\\text{s}`),e.$set(u)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){T(e.$$.fragment,r),i=!1},d(r){r&&P(o),K(e)}}}function Ee(t){let o,e,i;return e=new te({props:{expr:`\\text{Range: } ${t[0].min}\\text{--}${t[0].max}\\quad \\text{Ops: } ${t[0].ops.join("\\,")}`}}),{c(){o=$("span"),U(e.$$.fragment),ee(o,"slot","footer-right")},m(r,n){G(r,o,n),H(e,o,null),i=!0},p(r,n){const u={};n&1&&(u.expr=`\\text{Range: } ${r[0].min}\\text{--}${r[0].max}\\quad \\text{Ops: } ${r[0].ops.join("\\,")}`),e.$set(u)},i(r){i||(E(e.$$.fragment,r),i=!0)},o(r){T(e.$$.fragment,r),i=!1},d(r){r&&P(o),K(e)}}}function Y(t){let o,e,i,r;function n(s){t[16](s)}function u(s){t[17](s)}let m={title:"MathRaining",levelId:t[0].id,total:t[0].total,correct:t[12],showTimer:!t[6],remainingSeconds:t[7]/1e3,question:t[1].question,flash:t[4],penalty:t[5],overlayLabel:t[8],overlayColor:t[9],overlayTrigger:t[10],handleInput:t[13],handleInputKey:t[14],$$slots:{"footer-right":[Ee],"footer-left":[Te]},$$scope:{ctx:t}};return t[3]!==void 0&&(m.inputEl=t[3]),t[2]!==void 0&&(m.input=t[2]),o=new we({props:m}),Q.push(()=>Z(o,"inputEl",n)),Q.push(()=>Z(o,"input",u)),{c(){U(o.$$.fragment)},m(s,l){H(o,s,l),r=!0},p(s,l){const f={};l&1&&(f.levelId=s[0].id),l&1&&(f.total=s[0].total),l&4096&&(f.correct=s[12]),l&64&&(f.showTimer=!s[6]),l&128&&(f.remainingSeconds=s[7]/1e3),l&2&&(f.question=s[1].question),l&16&&(f.flash=s[4]),l&32&&(f.penalty=s[5]),l&256&&(f.overlayLabel=s[8]),l&512&&(f.overlayColor=s[9]),l&1024&&(f.overlayTrigger=s[10]),l&536872961&&(f.$$scope={dirty:l,ctx:s}),!e&&l&8&&(e=!0,f.inputEl=s[3],W(()=>e=!1)),!i&&l&4&&(i=!0,f.input=s[2],W(()=>i=!1)),o.$set(f)},i(s){r||(E(o.$$.fragment,s),r=!0)},o(s){T(o.$$.fragment,s),r=!1},d(s){K(o,s)}}}function Ae(t){let o=t[1].id,e,i,r=Y(t);return{c(){r.c(),e=ge()},m(n,u){r.m(n,u),G(n,e,u),i=!0},p(n,[u]){u&2&&v(o,o=n[1].id)?(de(),T(r,1,1,ye),he(),r=Y(n),r.c(),E(r,1),r.m(e.parentNode,e)):r.p(n,u)},i(n){i||(E(r),i=!0)},o(n){T(r),i=!1},d(n){n&&P(e),r.d(n)}}}const j=8e3;function Fe(t){return t===0?{label:"—",color:"#4C5B5C"}:t<2e3?{label:"perfect",color:"multi"}:t<4e3?{label:"great",color:"#2F52E0"}:t<6e3?{label:"good",color:"#BCED09"}:t<8e3?{label:"bad",color:"#F9CB40"}:{label:"miss",color:"#FF715B"}}function L(t,o){if(globalThis.crypto){const e=new Uint32Array(1);globalThis.crypto.getRandomValues(e);const i=e[0]/(2**32-1);return Math.floor(i*(o-t+1))+t}return Math.floor(Math.random()*(o-t+1))+t}function F(t,o,e){if(e<=1)return L(Math.max(1,t),o);const i=Math.max(1,Math.ceil(t/e)),r=Math.floor(o/e);return r<i?L(Math.max(1,t),o):e*L(i,r)}function _(t,o){return L(Math.max(1,t),o)}function Le(t,o,e){let i=j;return(t==="x"||t==="/")&&(i+=2e3),Math.max(Math.abs(o),Math.abs(e))>=50&&(i+=1500),i}function O(t,o,e){return t==="+"?o===0||e===0:t==="-"?o===e:t==="x"?o===0||e===0||o===1||e===1:t==="/"?e===0||e===1||o===e:!1}function Se(t,o,e){let i;const r=xe();let n=ne(1),u,m="",s=null,l=0,f=!1,S=!1,h=!0,y=0,g=j,q,C=!1,V=performance.now(),X=0,D="",I="",B=0,z=performance.now();function oe(){const a=n.ops[Math.floor(Math.random()*n.ops.length)],c=Array.isArray(n.multiples)&&n.multiples.length>0,b=c?n.multiples[Math.floor(Math.random()*n.multiples.length)]:1;let p=n.min,d=n.min;const x=60;if(a==="+"||a==="-"||a==="x"){let A=0;do p=c?F(n.min,n.max,b):_(n.min,n.max),d=c?F(n.min,n.max,b):_(n.min,n.max),A++;while(O(a,p,d)&&A<x)}else{let A=0,N=!1,k=1;for(;A++<x&&!N;){k=c?Math.max(1,F(1,Math.max(1,n.max),b)):Math.max(1,_(1,Math.max(1,n.max)));const M=Math.min(n.max,Math.floor(n.max/k));M<1||(d=c?Math.max(1,F(1,M,b)):_(1,M),p=k*d,p>=1&&p<=n.max&&!O("/",p,d)&&(N=!0))}if(!N){let M=0;do d=Math.max(1,_(n.min,n.max)),k=Math.max(1,_(n.min,n.max)),p=k*d,M++;while(O("/",p,d)&&M<x)}}const me=a==="+"?p+d:a==="-"?p-d:a==="x"?p*d:p/d,ue=`\\displaystyle ${p} \\; ${a==="+"?"+":a==="-"?"-":a==="x"?"\\times":"\\div"} \\; ${d}`,fe=Le(a,p,d);return{id:Math.random().toString(36).slice(2)+Date.now().toString(36),a:p,b:d,op:a,answer:me,question:ue,timeMs:fe}}function R(){e(1,u=oe()),h?(y=0,e(7,g=u.timeMs)):(y=performance.now()+u.timeMs,e(7,g=u.timeMs)),C=!1,V=performance.now()}function re(){e(15,l=0),e(2,m=""),e(4,f=!1),e(6,h=!0),e(11,z=performance.now()),R()}re();function w(a){let c=a.replace(/[^0-9\-]/g,"");if(c.indexOf("-")>0&&(c=c.replace(/-/g,"")),e(2,m=c),!c)return;if(Number(c)===u.answer){X=performance.now()-V;const p=Fe(X);e(8,D=p.label),e(9,I=p.color),e(10,B+=1),e(4,f=!0),e(15,l+=1),r("answer",{correct:!0});const d=l>=n.total;setTimeout(()=>{if(d){const x=ke(n.id);x&&(e(0,n=x),e(15,l=0),e(6,h=!0))}else e(6,h=!1);e(2,m=""),e(4,f=!1),R()},160)}}function ae(a){w(a.target.value)}function J(a){const c=a.target.tagName;if(["INPUT","TEXTAREA","SELECT"].includes(c))return a.target===s,void 0;if(a.key==="Backspace"){e(2,m=m.slice(0,-1)),w(m),a.preventDefault();return}if((a.key==="-"||a.key===" ")&&m.length===0){e(2,m="-"),w(m),a.preventDefault();return}if(/^[0-9]$/.test(a.key)){e(2,m+=a.key),w(m),a.preventDefault();return}a.key==="Escape"&&(e(2,m=""),a.preventDefault())}function se(a){if(a.key==="Shift"){a.preventDefault(),e(2,m="");return}a.key==="Control"||a.key==="Alt"||a.key==="Meta"||a.key===" "&&m.length===0&&(a.preventDefault(),e(2,m="-"),w(m))}Me(()=>{window.addEventListener("keydown",J),setTimeout(()=>s==null?void 0:s.focus(),0);const a=()=>{var c;y>0?(e(7,g=Math.max(0,y-performance.now())),!C&&g<=0&&(r("answer",{correct:!1}),C=!0,e(15,l-=2),e(8,D="miss"),e(9,I="#FF715B"),e(10,B+=1),e(5,S=!0),setTimeout(()=>e(5,S=!1),300),e(6,h=!1),e(2,m=""),e(4,f=!1),R())):e(7,g=(c=u==null?void 0:u.timeMs)!=null?c:j),q=requestAnimationFrame(a)};y=0,q=requestAnimationFrame(a)}),_e(()=>{window.removeEventListener("keydown",J),cancelAnimationFrame(q)});function ie(a){s=a,e(3,s)}function le(a){m=a,e(2,m)}return t.$$.update=()=>{t.$$.dirty&32768&&e(12,i=l<0?0:l)},[n,u,m,s,f,S,h,g,D,I,B,z,i,ae,se,l,ie,le]}class Ne extends pe{constructor(o){super(),ce(this,o,Se,Ae,v,{})}}export{Ne as default};
