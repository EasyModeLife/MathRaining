import{S as le,i as me,s as ue,b as V,a as Q,d as j,t as O,c as R,e as X,m as N,f as P,g as fe,o as pe,h as ce,j as Z,k as z,l as J,n as W}from"./index-nMkFgeKz.js";import{G as de}from"./GameFrame-DBxowu93.js";import Y from"./Math-DGExlrYu.js";const he=[{id:1,ops:["+","-"],min:1,max:9,total:12,desc:"Single-digit addition and subtraction"},{id:2,ops:["+","-","x"],min:1,max:9,total:12,desc:"Intro to multiplication with friendly tables",multiples:[2,5,10]},{id:3,ops:["+","-","x","/"],min:1,max:9,total:14,desc:"Introduce exact division (kept within range)",multiples:[3,4]},{id:4,ops:["+","-"],min:1,max:20,total:14,desc:"Add/sub within 1–20"},{id:5,ops:["x","/"],min:2,max:12,total:16,desc:"Times tables up to 12 (and their divisions)",multiples:[2,3,4,5,10]},{id:6,ops:["+","-","x","/"],min:1,max:30,total:18,desc:"Mixed up to 30",multiples:[2,5,10]},{id:7,ops:["+","-","x","/"],min:1,max:50,total:18,desc:"Mixed up to 50",multiples:[4,6,8]},{id:8,ops:["+","-","x","/"],min:1,max:80,total:20,desc:"Trickier multiples practice",multiples:[7,8,9]},{id:9,ops:["+","-","x","/"],min:1,max:90,total:20,desc:"Patterns and accuracy",multiples:[3,6,9]},{id:10,ops:["+","-","x","/"],min:1,max:99,total:22,desc:"Full two-digit practice (up to 99)"},{id:11,ops:["+","-"],min:10,max:199,total:18,desc:"Hundreds addition and subtraction"},{id:12,ops:["+","-","x"],min:1,max:199,total:20,desc:"Products with two/three digits",multiples:[5,10,25]},{id:13,ops:["+","-","x","/"],min:1,max:249,total:20,desc:"Mixed practice up to 250"},{id:14,ops:["+","-","x","/"],min:1,max:399,total:22,desc:"Mixed up to 399",multiples:[4,8,12]},{id:15,ops:["+","-","x","/"],min:1,max:499,total:22,desc:"Mixed up to 499"},{id:16,ops:["+","-","x","/"],min:1,max:699,total:24,desc:"Trickier factors",multiples:[7,11,13]},{id:17,ops:["+","-","x","/"],min:1,max:799,total:24,desc:"Heavier practice",multiples:[9,12,16]},{id:18,ops:["+","-","x","/"],min:1,max:899,total:24,desc:"Approaching thousands"},{id:19,ops:["+","-","x","/"],min:1,max:950,total:24,desc:"Round-number multiples",multiples:[20,25,50]},{id:20,ops:["+","-","x","/"],min:1,max:999,total:26,desc:"Three-digit mixed challenge (up to 999)"}];function v(n){return he.find(r=>r.id===n)}function ge(n){return v(n+1)}function xe(n){let r,e,m;return e=new Y({props:{expr:`\\displaystyle \\text{Time: } ${((performance.now()-n[11])/1e3).toFixed(1)}\\,\\text{s}`}}),{c(){r=J("span"),P(e.$$.fragment),W(r,"slot","footer-left")},m(s,t){z(s,r,t),N(e,r,null),m=!0},p(s,t){const p={};t&2048&&(p.expr=`\\displaystyle \\text{Time: } ${((performance.now()-s[11])/1e3).toFixed(1)}\\,\\text{s}`),e.$set(p)},i(s){m||(R(e.$$.fragment,s),m=!0)},o(s){O(e.$$.fragment,s),m=!1},d(s){s&&Z(r),j(e)}}}function Me(n){let r,e,m;return e=new Y({props:{expr:`\\text{Range: } ${n[0].min}\\text{--}${n[0].max}\\quad \\text{Ops: } ${n[0].ops.join("\\,")}`}}),{c(){r=J("span"),P(e.$$.fragment),W(r,"slot","footer-right")},m(s,t){z(s,r,t),N(e,r,null),m=!0},p(s,t){const p={};t&1&&(p.expr=`\\text{Range: } ${s[0].min}\\text{--}${s[0].max}\\quad \\text{Ops: } ${s[0].ops.join("\\,")}`),e.$set(p)},i(s){m||(R(e.$$.fragment,s),m=!0)},o(s){O(e.$$.fragment,s),m=!1},d(s){s&&Z(r),j(e)}}}function be(n){let r,e,m,s;function t(a){n[16](a)}function p(a){n[17](a)}let l={title:"MathRaining",levelId:n[0].id,total:n[0].total,correct:n[12],showTimer:!n[6],remainingSeconds:n[7]/1e3,question:n[1].question,flash:n[4],penalty:n[5],overlayLabel:n[8],overlayColor:n[9],overlayTrigger:n[10],handleInput:n[13],handleInputKey:n[14],$$slots:{"footer-right":[Me],"footer-left":[xe]},$$scope:{ctx:n}};return n[3]!==void 0&&(l.inputEl=n[3]),n[2]!==void 0&&(l.input=n[2]),r=new de({props:l}),V.push(()=>Q(r,"inputEl",t)),V.push(()=>Q(r,"input",p)),{c(){P(r.$$.fragment)},m(a,i){N(r,a,i),s=!0},p(a,[i]){const u={};i&1&&(u.levelId=a[0].id),i&1&&(u.total=a[0].total),i&4096&&(u.correct=a[12]),i&64&&(u.showTimer=!a[6]),i&128&&(u.remainingSeconds=a[7]/1e3),i&2&&(u.question=a[1].question),i&16&&(u.flash=a[4]),i&32&&(u.penalty=a[5]),i&256&&(u.overlayLabel=a[8]),i&512&&(u.overlayColor=a[9]),i&1024&&(u.overlayTrigger=a[10]),i&536872961&&(u.$$scope={dirty:i,ctx:a}),!e&&i&8&&(e=!0,u.inputEl=a[3],X(()=>e=!1)),!m&&i&4&&(m=!0,u.input=a[2],X(()=>m=!1)),r.$set(u)},i(a){s||(R(r.$$.fragment,a),s=!0)},o(a){O(r.$$.fragment,a),s=!1},d(a){j(r,a)}}}const B=8e3;function we(n){return n===0?{label:"—",color:"#4C5B5C"}:n<2e3?{label:"perfect",color:"multi"}:n<4e3?{label:"great",color:"#2F52E0"}:n<6e3?{label:"good",color:"#BCED09"}:n<8e3?{label:"bad",color:"#F9CB40"}:{label:"miss",color:"#FF715B"}}function E(n,r){return Math.floor(Math.random()*(r-n+1))+n}function x(n,r,e){if(e<=1)return E(Math.max(1,n),r);const m=Math.max(1,Math.ceil(n/e)),s=Math.floor(r/e);return s<m?E(Math.max(1,n),r):e*E(m,s)}function h(n,r){return E(Math.max(1,n),r)}function _e(n,r,e){let m=B;return(n==="x"||n==="/")&&(m+=2e3),Math.max(Math.abs(r),Math.abs(e))>=50&&(m+=1500),m}function ye(n,r,e){let m;const s=fe();let t=v(1),p,l="",a=null,i=0,u=!1,T=!1,M=!0,w=0,b=B,F,L=!1,G=performance.now(),H=0,q="",A="",C=0,K=performance.now();function $(){const o=t.ops[Math.floor(Math.random()*t.ops.length)],f=Array.isArray(t.multiples)&&t.multiples.length>0,g=f?t.multiples[Math.floor(Math.random()*t.multiples.length)]:1;let c=t.min,d=t.min;if(o==="+")c=f?x(t.min,t.max,g):h(t.min,t.max),d=f?x(t.min,t.max,g):h(t.min,t.max);else if(o==="-")c=f?x(t.min,t.max,g):h(t.min,t.max),d=f?x(t.min,t.max,g):h(t.min,t.max);else if(o==="x")c=f?x(t.min,t.max,g):h(t.min,t.max),d=f?x(t.min,t.max,g):h(t.min,t.max);else{let ie=0,D=!1,y=1;for(;ie++<20&&!D;){y=f?Math.max(1,x(1,Math.max(1,t.max),g)):Math.max(1,h(1,Math.max(1,t.max)));const I=Math.min(t.max,Math.floor(t.max/y));I<1||(d=f?Math.max(1,x(1,I,g)):h(1,I),c=y*d,c>=1&&c<=t.max&&(D=!0))}D||(d=Math.max(1,h(t.min,t.max)),y=Math.max(1,h(t.min,t.max)),c=y*d)}const k=o==="+"?c+d:o==="-"?c-d:o==="x"?c*d:c/d,ae=`\\displaystyle ${c} \\; ${o==="+"?"+":o==="-"?"-":o==="x"?"\\times":"\\div"} \\; ${d}`,se=_e(o,c,d);return{id:Math.random().toString(36).slice(2)+Date.now().toString(36),a:c,b:d,op:o,answer:k,question:ae,timeMs:se}}function S(){e(1,p=$()),M?(w=0,e(7,b=p.timeMs)):(w=performance.now()+p.timeMs,e(7,b=p.timeMs)),L=!1,G=performance.now()}function ee(){e(15,i=0),e(2,l=""),e(4,u=!1),e(6,M=!0),e(11,K=performance.now()),S()}ee();function _(o){let f=o.replace(/[^0-9\-]/g,"");if(f.indexOf("-")>0&&(f=f.replace(/-/g,"")),e(2,l=f),!f)return;if(Number(f)===p.answer){H=performance.now()-G;const c=we(H);e(8,q=c.label),e(9,A=c.color),e(10,C+=1),e(4,u=!0),e(15,i+=1),s("answer",{correct:!0});const d=i>=t.total;setTimeout(()=>{if(d){const k=ge(t.id);k&&(e(0,t=k),e(15,i=0),e(6,M=!0))}else e(6,M=!1);e(2,l=""),e(4,u=!1),S()},160)}}function te(o){_(o.target.value)}function U(o){const f=o.target.tagName;if(["INPUT","TEXTAREA","SELECT"].includes(f))return o.target===a,void 0;if(o.key==="Backspace"){e(2,l=l.slice(0,-1)),_(l),o.preventDefault();return}if((o.key==="-"||o.key===" ")&&l.length===0){e(2,l="-"),_(l),o.preventDefault();return}if(/^[0-9]$/.test(o.key)){e(2,l+=o.key),_(l),o.preventDefault();return}o.key==="Escape"&&(e(2,l=""),o.preventDefault())}function ne(o){if(o.key==="Shift"){o.preventDefault(),e(2,l="");return}o.key==="Control"||o.key==="Alt"||o.key==="Meta"||o.key===" "&&l.length===0&&(o.preventDefault(),e(2,l="-"),_(l))}pe(()=>{window.addEventListener("keydown",U),setTimeout(()=>a==null?void 0:a.focus(),0);const o=()=>{var f;w>0?(e(7,b=Math.max(0,w-performance.now())),!L&&b<=0&&(s("answer",{correct:!1}),L=!0,e(15,i-=2),e(8,q="miss"),e(9,A="#FF715B"),e(10,C+=1),e(5,T=!0),setTimeout(()=>e(5,T=!1),300),e(6,M=!1),e(2,l=""),e(4,u=!1),S())):e(7,b=(f=p==null?void 0:p.timeMs)!=null?f:B),F=requestAnimationFrame(o)};w=0,F=requestAnimationFrame(o)}),ce(()=>{window.removeEventListener("keydown",U),cancelAnimationFrame(F)});function oe(o){a=o,e(3,a)}function re(o){l=o,e(2,l)}return n.$$.update=()=>{n.$$.dirty&32768&&e(12,m=i<0?0:i)},[t,p,l,a,u,T,M,b,q,A,C,K,m,te,ne,i,oe,re]}class Le extends le{constructor(r){super(),me(this,r,ye,be,ue,{})}}export{Le as default};
