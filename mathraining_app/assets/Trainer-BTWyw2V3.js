import{S as Z,d as $,e as P,h as Q,t as I,b as q,a as ee,c as te,l as G,A as oe,F as ne,G as re,J as se,K as v,L as F,x as ae,M as B,z as ie,y as le,j as ce,m as O,p as fe,u as j,k as ue,v as pe}from"./index-DLn-mdrQ.js";import{G as me}from"./GameFrame-Bq2yWsVP.js";/* empty css                                           */import"./SubNav-s1jv8jbS.js";import"./Math-CqWuv0qz.js";const ge=[{id:1,topics:["derivative-poly"],total:10,desc:"Derivadas de polinomios simples"},{id:2,topics:["integral-poly"],total:10,desc:"Integrales de polinomios básicas"},{id:3,topics:["derivative-trig"],total:12,desc:"Derivadas trigonométricas"},{id:4,topics:["differential-poly"],total:12,desc:"Diferenciales: dy = f’(x) dx"},{id:5,topics:["derivative-poly","integral-poly","derivative-trig","differential-poly"],total:14,desc:"Mixto de cálculo"}];function V(t){return ge.find(o=>o.id===t)}function de(t){return V(t+1)}function m(t,o){if(globalThis.crypto){const e=new Uint32Array(1);globalThis.crypto.getRandomValues(e);const s=e[0]/(2**32-1);return Math.floor(s*(o-t+1))+t}return Math.floor(Math.random()*(o-t+1))+t}function S(t){return t==="derivative-trig"?15e3:t==="differential-poly"?19e3:17e3}function b(t){const o=[];t.forEach((s,i)=>{const r=t.length-1-i;if(s===0)return;const l=s>0?"+":"-",f=Math.abs(s);let n="";r===0?n=`${f}`:f===1?n=r===1?"x":`x^{${r}}`:n=r===1?`${f}x`:`${f}x^{${r}}`,o.push(`${l} ${n}`)});let e=o.join(" ");return e=e.replace(/^\+\s?/,"").trim(),e||"0"}function x(t){const o=[];for(let e=0;e<t.length-1;e++){const s=t.length-1-e;o.push(t[e]*s)}return o.length?o:[0]}function he(t){const o=[];for(let s=0;s<t.length;s++){const r=t.length-1-s+1,l=t[s]/r;if(l===0)continue;const f=l>0?"+":"-",n=Math.abs(l);let a="";r===0?a=`${n}`:n===1?a=r===1?"x":`x^{${r}}`:a=r===1?`${n}x`:`${n}x^{${r}}`,o.push(`${f} ${a}`)}const e=o.join(" ").replace(/^\+\s/,"").trim();return e?`${e} + C`:"C"}function _e(t,o){return t.reduce((e,s)=>e*o+s,0)}function ye(t){const o=t[m(0,t.length-1)];if(o==="derivative-poly"){const c=m(1,3),u=Array.from({length:c+1},()=>m(-6,6));u[0]===0&&(u[0]=m(1,6));const d=`\\frac{d}{dx} [${b(u)}]`,h=x(u),_=b(h).replace(/^\+\s?/,"").trim();return{id:`${Math.random().toString(36).slice(2)}${Date.now().toString(36)}`,question:d,answer:_,topic:o,timeMs:S(o)}}if(o==="integral-poly"){const c=m(0,3),u=Array.from({length:c+1},()=>m(-5,5));u.reduce((y,w)=>y+Math.abs(w),0)===0&&(u[c]=1);const h=`\\int (${b(u)}) \\, dx`,_=he(u);return{id:`${Math.random().toString(36).slice(2)}${Date.now().toString(36)}`,question:h,answer:_,topic:o,timeMs:S(o)}}if(o==="derivative-trig"){const c=["\\sin x","\\cos x","\\tan x"],u=c[m(0,c.length-1)],g=`\\frac{d}{dx} [${u}]`,d=u==="\\sin x"?"\\cos x":u==="\\cos x"?"-\\sin x":"\\sec^{2} x";return{id:`${Math.random().toString(36).slice(2)}${Date.now().toString(36)}`,question:g,answer:d,topic:o,timeMs:S(o)}}const e=m(1,3),s=Array.from({length:e+1},()=>m(-5,5));s[0]===0&&(s[0]=m(1,5));const i=x(s),r=m(-4,4),l=b(s),f=b(i).replace(/^\+\s?/,""),n=`\\text{If } y = ${l}, \\text{ find } dy \\text{ at } x = ${r} \\text{ } (dy = y'(x) \\, dx)`,a=`dy = (${f}) \\, dx, \\quad y'(${r}) = ${_e(i,r)}`;return{id:`${Math.random().toString(36).slice(2)}${Date.now().toString(36)}`,question:n,answer:a,topic:"differential-poly",timeMs:S(o)}}function Me(t){let o,e,s=t[0].topics.length+"",i;return{c(){o=fe("span"),e=j("Topics: "),i=j(s),ue(o,"slot","footer-right")},m(r,l){G(r,o,l),O(o,e),O(o,i)},p(r,l){l&1&&s!==(s=r[0].topics.length+"")&&ce(i,s)},d(r){r&&Q(o)}}}function N(t){let o,e,s,i;function r(n){t[15](n)}function l(n){t[16](n)}let f={title:"Calculus",levelId:t[0].id,total:t[0].total,correct:t[11],showTimer:!t[6],remainingSeconds:t[7]/1e3,question:t[1].question,flash:t[4],penalty:t[5],overlayLabel:t[8],overlayColor:t[9],overlayTrigger:t[10],handleInput:t[12],handleInputKey:t[13],$$slots:{"footer-right":[Me]},$$scope:{ctx:t}};return t[3]!==void 0&&(f.inputEl=t[3]),t[2]!==void 0&&(f.input=t[2]),o=new me({props:f}),v.push(()=>F(o,"inputEl",r)),v.push(()=>F(o,"input",l)),{c(){le(o.$$.fragment)},m(n,a){ie(o,n,a),i=!0},p(n,a){const c={};a&1&&(c.levelId=n[0].id),a&1&&(c.total=n[0].total),a&2048&&(c.correct=n[11]),a&64&&(c.showTimer=!n[6]),a&128&&(c.remainingSeconds=n[7]/1e3),a&2&&(c.question=n[1].question),a&16&&(c.flash=n[4]),a&32&&(c.penalty=n[5]),a&256&&(c.overlayLabel=n[8]),a&512&&(c.overlayColor=n[9]),a&1024&&(c.overlayTrigger=n[10]),a&134217729&&(c.$$scope={dirty:a,ctx:n}),!e&&a&8&&(e=!0,c.inputEl=n[3],B(()=>e=!1)),!s&&a&4&&(s=!0,c.input=n[2],B(()=>s=!1)),o.$set(c)},i(n){i||(q(o.$$.fragment,n),i=!0)},o(n){I(o.$$.fragment,n),i=!1},d(n){ae(o,n)}}}function we(t){let o=t[1].id,e,s,i=N(t);return{c(){i.c(),e=oe()},m(r,l){i.m(r,l),G(r,e,l),s=!0},p(r,[l]){l&2&&P(o,o=r[1].id)?(ee(),I(i,1,1,pe),te(),i=N(r),i.c(),q(i,1),i.m(e.parentNode,e)):i.p(r,l)},i(r){s||(q(i),s=!0)},o(r){I(i),s=!1},d(r){r&&Q(e),i.d(r)}}}const U=12e3;function be(t,o,e){let s;const i=ne();let r=V(1),l,f="",n=null,a=0,c=!1,u=!1,g=!0,d=0,h=U,_,y=!1;performance.now();let w="",T="",C=0;performance.now();function z(){return ye(r.topics)}function E(){e(1,l=z()),g?(d=0,e(7,h=l.timeMs)):(d=performance.now()+l.timeMs,e(7,h=l.timeMs)),y=!1,performance.now()}function K(){e(14,a=0),e(2,f=""),e(4,c=!1),e(6,g=!0),performance.now(),E()}K();function k(p){let M=p.trim();if(e(2,f=M),!M)return;const L=A=>A.replace(/\\/g,"").replace(/\{(\d+)\}/g,"$1").replace(/frac\{([^}]+)\}\{([^}]+)\}/g,"$1/$2").replace(/\^\{(\w+)\}/g,"^$1").replace(/\^\{([^}]*)\}/g,"^$1").replace(/\s*([-+])\s*/g,"$1").replace(/\s+/g," ").replace(/^\+\s?/,"").replace(/^-\s*0(\s|$)/,"0$1").trim().toLowerCase(),W=L(M),Y=L(l.answer);if(W===Y){e(8,w="correct"),e(9,T="#BCED09"),e(10,C+=1),e(4,c=!0),e(14,a+=1),i("answer",{correct:!0});const A=a>=r.total;setTimeout(()=>{if(e(2,f=""),e(4,c=!1),A){const D=de(r.id);D&&(e(0,r=D),e(14,a=0),e(6,g=!0),E())}else e(6,g=!1),E()},200)}}function R(p){k(p.target.value)}function H(p){p.key==="Enter"&&k(f)}re(()=>{setTimeout(()=>n==null?void 0:n.focus(),0);const p=()=>{var M;d>0?(e(7,h=Math.max(0,d-performance.now())),!y&&h<=0&&(i("answer",{correct:!1}),y=!0,e(14,a=Math.max(0,a-1)),e(8,w="miss"),e(9,T="#FF715B"),e(10,C+=1),e(5,u=!0),setTimeout(()=>e(5,u=!1),250),e(6,g=!1),e(2,f=""),e(4,c=!1),E())):e(7,h=(M=l==null?void 0:l.timeMs)!=null?M:U),_=requestAnimationFrame(p)};d=0,_=requestAnimationFrame(p)}),se(()=>cancelAnimationFrame(_));function J(p){n=p,e(3,n)}function X(p){f=p,e(2,f)}return t.$$.update=()=>{t.$$.dirty&16384&&e(11,s=Math.max(0,a))},[r,l,f,n,c,u,g,h,w,T,C,s,R,H,a,J,X]}class qe extends Z{constructor(o){super(),$(this,o,be,we,P,{})}}export{qe as default};
