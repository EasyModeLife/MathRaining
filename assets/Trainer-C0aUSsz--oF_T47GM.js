import{K as st,U as mt,j as ut,y as N,o as _,P as S,k as B,v as R,c as G,E as O,L as P,a as ct,O as pt,l as dt,b as X,$ as z,p as J,d as Q}from"./index-CFTrthGh.js";import{a as xt}from"./GameFrame-DpBzU2T0-DDxwDYeb.js";import V from"./Math-BOqx12LK-CJRqjFux.js";const ft=[{id:1,ops:["+","-"],min:1,max:9,total:12,desc:"Single-digit addition and subtraction"},{id:2,ops:["+","-","x"],min:1,max:9,total:12,desc:"Intro to multiplication with friendly tables",multiples:[2,5,10]},{id:3,ops:["+","-","x","/"],min:1,max:9,total:14,desc:"Introduce exact division (kept within range)",multiples:[3,4]},{id:4,ops:["+","-"],min:1,max:20,total:14,desc:"Add/sub within 1–20"},{id:5,ops:["x","/"],min:2,max:12,total:16,desc:"Times tables up to 12 (and their divisions)",multiples:[2,3,4,5,10]},{id:6,ops:["+","-","x","/"],min:1,max:30,total:18,desc:"Mixed up to 30",multiples:[2,5,10]},{id:7,ops:["+","-","x","/"],min:1,max:50,total:18,desc:"Mixed up to 50",multiples:[4,6,8]},{id:8,ops:["+","-","x","/"],min:1,max:80,total:20,desc:"Trickier multiples practice",multiples:[7,8,9]},{id:9,ops:["+","-","x","/"],min:1,max:90,total:20,desc:"Patterns and accuracy",multiples:[3,6,9]},{id:10,ops:["+","-","x","/"],min:1,max:99,total:22,desc:"Full two-digit practice (up to 99)"},{id:11,ops:["+","-"],min:10,max:199,total:18,desc:"Hundreds addition and subtraction"},{id:12,ops:["+","-","x"],min:1,max:199,total:20,desc:"Products with two/three digits",multiples:[5,10,25]},{id:13,ops:["+","-","x","/"],min:1,max:249,total:20,desc:"Mixed practice up to 250"},{id:14,ops:["+","-","x","/"],min:1,max:399,total:22,desc:"Mixed up to 399",multiples:[4,8,12]},{id:15,ops:["+","-","x","/"],min:1,max:499,total:22,desc:"Mixed up to 499"},{id:16,ops:["+","-","x","/"],min:1,max:699,total:24,desc:"Trickier factors",multiples:[7,11,13]},{id:17,ops:["+","-","x","/"],min:1,max:799,total:24,desc:"Heavier practice",multiples:[9,12,16]},{id:18,ops:["+","-","x","/"],min:1,max:899,total:24,desc:"Approaching thousands"},{id:19,ops:["+","-","x","/"],min:1,max:950,total:24,desc:"Round-number multiples",multiples:[20,25,50]},{id:20,ops:["+","-","x","/"],min:1,max:999,total:26,desc:"Three-digit mixed challenge (up to 999)"}];function W(a){return ft.find(n=>n.id===a)}function ht(a){return W(a+1)}function $t(a){let n,t,m;return t=new V({props:{expr:`\\displaystyle \\text{Time: } ${((performance.now()-a[11])/1e3).toFixed(1)}\\,\\text{s}`}}),{c(){n=J("span"),P(t.$$.fragment),Q(n,"slot","footer-left")},m(r,e){z(r,n,e),O(t,n,null),m=!0},p(r,e){const d={};e&2048&&(d.expr=`\\displaystyle \\text{Time: } ${((performance.now()-r[11])/1e3).toFixed(1)}\\,\\text{s}`),t.$set(d)},i(r){m||(R(t.$$.fragment,r),m=!0)},o(r){B(t.$$.fragment,r),m=!1},d(r){r&&X(n),S(t)}}}function gt(a){let n,t,m;return t=new V({props:{expr:`\\text{Range: } ${a[0].min}\\text{--}${a[0].max}\\quad \\text{Ops: } ${a[0].ops.join("\\,")}`}}),{c(){n=J("span"),P(t.$$.fragment),Q(n,"slot","footer-right")},m(r,e){z(r,n,e),O(t,n,null),m=!0},p(r,e){const d={};e&1&&(d.expr=`\\text{Range: } ${r[0].min}\\text{--}${r[0].max}\\quad \\text{Ops: } ${r[0].ops.join("\\,")}`),t.$set(d)},i(r){m||(R(t.$$.fragment,r),m=!0)},o(r){B(t.$$.fragment,r),m=!1},d(r){r&&X(n),S(t)}}}function Mt(a){let n,t,m,r;function e(o){a[16](o)}function d(o){a[17](o)}let s={title:"MathRaining",levelId:a[0].id,total:a[0].total,correct:a[12],showTimer:!a[6],remainingSeconds:a[7]/1e3,question:a[1].question,flash:a[4],penalty:a[5],overlayLabel:a[8],overlayColor:a[9],overlayTrigger:a[10],handleInput:a[13],handleInputKey:a[14],$$slots:{"footer-right":[gt],"footer-left":[$t]},$$scope:{ctx:a}};return a[3]!==void 0&&(s.inputEl=a[3]),a[2]!==void 0&&(s.input=a[2]),n=new xt({props:s}),N.push(()=>_(n,"inputEl",e)),N.push(()=>_(n,"input",d)),{c(){P(n.$$.fragment)},m(o,l){O(n,o,l),r=!0},p(o,[l]){const u={};l&1&&(u.levelId=o[0].id),l&1&&(u.total=o[0].total),l&4096&&(u.correct=o[12]),l&64&&(u.showTimer=!o[6]),l&128&&(u.remainingSeconds=o[7]/1e3),l&2&&(u.question=o[1].question),l&16&&(u.flash=o[4]),l&32&&(u.penalty=o[5]),l&256&&(u.overlayLabel=o[8]),l&512&&(u.overlayColor=o[9]),l&1024&&(u.overlayTrigger=o[10]),l&536872961&&(u.$$scope={dirty:l,ctx:o}),!t&&l&8&&(t=!0,u.inputEl=o[3],G(()=>t=!1)),!m&&l&4&&(m=!0,u.input=o[2],G(()=>m=!1)),n.$set(u)},i(o){r||(R(n.$$.fragment,o),r=!0)},o(o){B(n.$$.fragment,o),r=!1},d(o){S(n,o)}}}const L=8e3;function yt(a){return a===0?{label:"—",color:"#4C5B5C"}:a<2e3?{label:"perfect",color:"multi"}:a<4e3?{label:"great",color:"#2F52E0"}:a<6e3?{label:"good",color:"#BCED09"}:a<8e3?{label:"bad",color:"#F9CB40"}:{label:"miss",color:"#FF715B"}}function b(a,n){return Math.floor(Math.random()*(n-a+1))+a}function $(a,n,t){if(t<=1)return b(Math.max(1,a),n);const m=Math.max(1,Math.ceil(a/t)),r=Math.floor(n/t);return r<m?b(Math.max(1,a),n):t*b(m,r)}function h(a,n){return b(Math.max(1,a),n)}function wt(a,n,t){let m=L;return(a==="x"||a==="/")&&(m+=2e3),Math.max(Math.abs(n),Math.abs(t))>=50&&(m+=1500),m}function vt(a,n,t){let m;const r=ct();let e=W(1),d,s="",o=null,l=0,u=!1,k=!1,g=!0,y=0,M=L,T,E=!1,U=performance.now(),j=0,F="",A="",q=0,H=performance.now();function Y(){const i=e.ops[Math.floor(Math.random()*e.ops.length)],c=Array.isArray(e.multiples)&&e.multiples.length>0,f=c?e.multiples[Math.floor(Math.random()*e.multiples.length)]:1;let x=e.min,p=e.min;if(i==="+")x=c?$(e.min,e.max,f):h(e.min,e.max),p=c?$(e.min,e.max,f):h(e.min,e.max);else if(i==="-")x=c?$(e.min,e.max,f):h(e.min,e.max),p=c?$(e.min,e.max,f):h(e.min,e.max);else if(i==="x")x=c?$(e.min,e.max,f):h(e.min,e.max),p=c?$(e.min,e.max,f):h(e.min,e.max);else{let lt=0,D=!1,v=1;for(;lt++<20&&!D;){v=c?Math.max(1,$(1,Math.max(1,e.max),f)):Math.max(1,h(1,Math.max(1,e.max)));const I=Math.min(e.max,Math.floor(e.max/v));I<1||(p=c?Math.max(1,$(1,I,f)):h(1,I),x=v*p,x>=1&&x<=e.max&&(D=!0))}D||(p=Math.max(1,h(e.min,e.max)),v=Math.max(1,h(e.min,e.max)),x=v*p)}const nt=i==="+"?x+p:i==="-"?x-p:i==="x"?x*p:x/p,ot=`\\displaystyle ${x} \\; ${i==="+"?"+":i==="-"?"-":i==="x"?"\\times":"\\div"} \\; ${p}`,rt=wt(i,x,p);return{id:Math.random().toString(36).slice(2)+Date.now().toString(36),a:x,b:p,op:i,answer:nt,question:ot,timeMs:rt}}function C(){t(1,d=Y()),g?(y=0,t(7,M=d.timeMs)):(y=performance.now()+d.timeMs,t(7,M=d.timeMs)),E=!1,U=performance.now()}function Z(){t(15,l=0),t(2,s=""),t(4,u=!1),t(6,g=!0),t(11,H=performance.now()),C()}Z();function w(i){let c=i.replace(/[^0-9\-]/g,"");if(c.indexOf("-")>0&&(c=c.replace(/-/g,"")),t(2,s=c),!!c&&Number(c)===d.answer){j=performance.now()-U;const f=yt(j);t(8,F=f.label),t(9,A=f.color),t(10,q+=1),t(4,u=!0),t(15,l+=1),r("answer",{correct:!0});const x=l>=e.total;setTimeout(()=>{if(x){const p=ht(e.id);p&&(t(0,e=p),t(15,l=0),t(6,g=!0))}else t(6,g=!1);t(2,s=""),t(4,u=!1),C()},160)}}function tt(i){w(i.target.value)}function K(i){const c=i.target.tagName;if(["INPUT","TEXTAREA","SELECT"].includes(c))return i.target,void 0;if(i.key==="Backspace"){t(2,s=s.slice(0,-1)),w(s),i.preventDefault();return}if((i.key==="-"||i.key===" ")&&s.length===0){t(2,s="-"),w(s),i.preventDefault();return}if(/^[0-9]$/.test(i.key)){t(2,s+=i.key),w(s),i.preventDefault();return}i.key==="Escape"&&(t(2,s=""),i.preventDefault())}function et(i){if(i.key==="Shift"){i.preventDefault(),t(2,s="");return}i.key==="Control"||i.key==="Alt"||i.key==="Meta"||i.key===" "&&s.length===0&&(i.preventDefault(),t(2,s="-"),w(s))}pt(()=>{window.addEventListener("keydown",K),setTimeout(()=>o==null?void 0:o.focus(),0);const i=()=>{var c;y>0?(t(7,M=Math.max(0,y-performance.now())),!E&&M<=0&&(r("answer",{correct:!1}),E=!0,t(15,l-=2),t(8,F="miss"),t(9,A="#FF715B"),t(10,q+=1),t(5,k=!0),setTimeout(()=>t(5,k=!1),300),t(6,g=!1),t(2,s=""),t(4,u=!1),C())):t(7,M=(c=d==null?void 0:d.timeMs)!=null?c:L),T=requestAnimationFrame(i)};y=0,T=requestAnimationFrame(i)}),dt(()=>{window.removeEventListener("keydown",K),cancelAnimationFrame(T)});function at(i){o=i,t(3,o)}function it(i){s=i,t(2,s)}return a.$$.update=()=>{a.$$.dirty&32768&&t(12,m=l<0?0:l)},[e,d,s,o,u,k,g,M,F,A,q,H,m,tt,et,l,at,it]}class Et extends st{constructor(n){super(),mt(this,n,vt,Mt,ut,{})}}export{Et as default};
